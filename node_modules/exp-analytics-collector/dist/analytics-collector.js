(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("expAnalyticsCollector", [], factory);
	else if(typeof exports === 'object')
		exports["expAnalyticsCollector"] = factory();
	else
		root["expAnalyticsCollector"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	var AnalyticsCollector = __webpack_require__(1);
	module.exports = new AnalyticsCollector['default']();

/***/ },
/* 1 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	var _analyticEvent = __webpack_require__(2);

	var _analyticEvent2 = _interopRequireDefault(_analyticEvent);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	var DEFAULT_VERSION = 1;
	var noop = function noop() {};

	var AnalyticsCollector = (function () {
	  function AnalyticsCollector() {
	    _classCallCheck(this, AnalyticsCollector);
	  }

	  _createClass(AnalyticsCollector, [{
	    key: 'init',
	    value: function init(urlBase, appName, gaId, mfgId, campaignId) {
	      var AnalyticEventImpl = arguments.length <= 5 || arguments[5] === undefined ? _analyticEvent2.default : arguments[5];
	      var ga = arguments.length <= 6 || arguments[6] === undefined ? window.ga : arguments[6];

	      this.url = urlBase + '/1.0/analyticEvent';
	      this.appName = appName;
	      this.gaId = gaId;
	      this.mfgId = mfgId;
	      this.campaignId = campaignId;
	      this.rootEventId = '';
	      this.AnalyticEvent = AnalyticEventImpl;
	      this.ga = ga;

	      this.sendToGA('create', this.gaId, 'auto');
	      return this;
	    }
	  }, {
	    key: 'sendEvent',
	    value: function sendEvent(action) {
	      var data = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];
	      var version = arguments.length <= 2 || arguments[2] === undefined ? DEFAULT_VERSION : arguments[2];
	      var consumers = arguments.length <= 3 || arguments[3] === undefined ? [] : arguments[3];
	      var parent = arguments.length <= 4 || arguments[4] === undefined ? this.rootEventId : arguments[4];
	      var fireOffGA = arguments.length <= 5 || arguments[5] === undefined ? false : arguments[5];
	      var success = arguments.length <= 6 || arguments[6] === undefined ? noop : arguments[6];
	      var error = arguments.length <= 7 || arguments[7] === undefined ? noop : arguments[7];

	      return this.doSend(this.createAnalyticsEvent(action, data, version, consumers, parent), fireOffGA, success, error);
	    }
	  }, {
	    key: 'createAnalyticsEvent',
	    value: function createAnalyticsEvent(action, data, version, consumers, parent) {
	      return new this.AnalyticEvent(action, data, this.appName, version, this.guid(), consumers, parent).toJSON();
	    }
	  }, {
	    key: 'doSend',
	    value: function doSend(data) {
	      var fireOffGa = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];
	      var success = arguments.length <= 2 || arguments[2] === undefined ? noop : arguments[2];
	      var error = arguments.length <= 3 || arguments[3] === undefined ? noop : arguments[3];

	      data.url = window.location.href;
	      data.userAgent = navigator.userAgent;
	      data.referrer = document.referrer;
	      data.mfgId = data.mfgId || this.mfgId;
	      data.campaignId = data.campaignId || this.campaignId;

	      if (fireOffGa) {
	        this.sendToGA('send', 'event', this.appName, data.action, data.label || data.url, {
	          hitCallback: success
	        });
	      }

	      this.doPostRequest(data, success, error);

	      return data;
	    }
	  }, {
	    key: 'pv',
	    value: function pv(data) {
	      var success = arguments.length <= 1 || arguments[1] === undefined ? noop : arguments[1];
	      var error = arguments.length <= 2 || arguments[2] === undefined ? noop : arguments[2];

	      this.sendToGA('send', 'pageview');

	      this.rootEventId = this.sendEvent('PAGEVIEW', data, 1, undefined, undefined, false, success, error).eventId;
	      return this.rootEventId;
	    }
	  }, {
	    key: 'guid',
	    value: function guid() {
	      var s4 = function s4() {
	        return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
	      };

	      return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
	    }
	  }, {
	    key: 'sendToGA',
	    value: function sendToGA() {
	      if (this.ga && this.gaId) {
	        this.ga.apply(null, arguments);
	      }
	    }
	  }, {
	    key: 'doPostRequest',
	    value: function doPostRequest(data) {
	      var success = arguments.length <= 1 || arguments[1] === undefined ? noop : arguments[1];
	      var error = arguments.length <= 2 || arguments[2] === undefined ? noop : arguments[2];

	      var xhr = undefined;
	      var body = JSON.stringify(data);

	      if (window.XMLHttpRequest) {
	        xhr = new window.XMLHttpRequest();
	      } else if (window.ActiveXObject) {
	        xhr = new window.ActiveXObject('MSXML2.XMLHTTP.3.0');
	      } else {
	        throw new Error('Cannot make request due to the browser being old');
	      }

	      xhr.open('POST', this.url);
	      xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
	      xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
	      xhr.send(body);
	      xhr.onreadystatechange = function () {
	        if (xhr.readyState === 4) {
	          if (xhr.status < 300) {

	            try {
	              success.call(this, JSON.parse(xhr.responseText));
	            } catch (e) {
	              error.call(this, e);
	            }
	          } else {
	            error.call(this, xhr.responseText || xhr.statusText);
	          }
	        }
	      };
	    }
	  }]);

	  return AnalyticsCollector;
	})();

	exports.default = AnalyticsCollector;

/***/ },
/* 2 */
/***/ function(module, exports) {

	'use strict';

	var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	var AnalyticEvent = (function () {
	  function AnalyticEvent(action, data, appName, version, eventId, consumers, parentEventId) {
	    _classCallCheck(this, AnalyticEvent);

	    this.action = action;
	    this.data = data;
	    this.appName = appName;
	    this.version = version;
	    this.eventId = eventId;
	    this.parentEventId = parentEventId;
	    this.userAgent = '';
	    this.url = '';
	    this.mfgId = '';
	    this.campaignId = '';
	    this.referrer = '';

	    if (consumers) {
	      if (Array.isArray(consumers)) {
	        this.consumers = consumers;
	      } else {
	        this.consumers = [consumers];
	      }
	    }
	  }

	  _createClass(AnalyticEvent, [{
	    key: 'toJSON',
	    value: function toJSON() {
	      var _this = this;

	      var hash = {};

	      Object.keys(this).forEach(function (key) {
	        hash[key] = _this[key];
	      });

	      return hash;
	    }
	  }]);

	  return AnalyticEvent;
	})();

	exports.default = AnalyticEvent;

/***/ }
/******/ ])
});
;